import{defineComponent as e,createVNode as t,ref as n,resolveComponent as l,openBlock as s,createBlock as r,createApp as a}from"https://unpkg.com/vue@3.1.5/dist/vue.runtime.esm-browser.prod.js";import{m as o}from"./vendor.2311e4c1.js";function u(e){const t=new Map;return e.split("\r\n").forEach((e=>{t.set(function(e){return o(e)}(e),e)})),t}function i(e,t,n=!0){const l={},s={};e instanceof Map?(l.keys=[...e.keys()],l.values=[...e.values()]):(l.keys=e,l.values=e),t instanceof Map?(s.keys=[...t.keys()],s.values=[...t.values()]):s.keys=s.values=e;const r=l.keys,a=s.keys;let o=function(e,t,n){const l={x:e.length,y:t.length},s=[];for(let a=n.length-1;a>0;--a){const e=n[a-1],t=l.x-l.y,r=t===-a||t!==-a&&e.get(t-1)<e.get(t+1)?t+1:t-1,o=e.get(r),u=o-r;for(;l.x>o&&l.y>u;)s.push("move"),l.x-=1,l.y-=1;l.x===o?s.push("insert"):s.push("delete"),l.x=o,l.y=u}let r=n[0]?n[0].get(0):0;for(;r;)s.push("move"),--r;return s}(r,a,function(e,t){const n=e.length,l=t.length,s=n+l,r=[new Map([[0,0]])];for(let a=0;a<=s;++a){if(0===a){let s=0;for(;n>s&&l>s&&e[s]===t[s];)++s;if(r[0].set(0,s),s===n&&s===l)return[];continue}const s=new Map([...Array.from(r[a-1])]),o=new Map;for(let u=-a;u<=a;u+=2){const i=u===-a||u!==a&&s.get(u-1)<s.get(u+1),f=i?u+1:u-1,c=s.get(f),h=i?c:c+1;let p=h,v=h-u;for(;p<n&&v<l&&e[p]===t[v];)++p,++v;if(o.set(u,p),p===n&&v===l)return r.push(o),r}r.push(o)}return[]}(r,a)).reverse();return 0===r.length&&0!==a.length&&(o=Array(a.length).fill("insert")),0===a.length&&0!==r.length&&(o=Array(r.length).fill("delete")),n&&function(e,t,n){let l=0,s=0;n.forEach((n=>{switch(n){case"insert":console.log(`[42;30m+${t[l++]}[0m`);break;case"move":s++,++l;break;case"delete":console.log(`[41;30m-${e[s++]}[0m`)}}))}(l.values,s.values,o),o}function f(e){switch(e){case"insert":return"+";case"delete":return"-";case"move":return" "}}var c=e({props:{data:{type:Array,default:()=>[]}},setup:e=>()=>t("section",{class:"diff-view"},[e.data.map((e=>{const{left:n,right:l}=e;return t("div",null,[t("span",{class:n[0]},[f(n[0]),n[1]]),t("span",{class:l[0]},[f(l[0]),l[1]])])}))])});c.__scopeId="data-v-844ca326";var h=e({components:{renderDiff:c},setup(){const e=n(),t=n(),l=n();return{renderData:l,leftFileRef:e,rightFileRef:t,handleDiff:async function(){var n,s;const r=null==(n=e.value)?void 0:n.files,a=null==(s=t.value)?void 0:s.files;if(!(null==r?void 0:r.length)||!(null==a?void 0:a.length))return;const o=r[0],f=a[0],c=await o.text(),h=await f.text(),p=u(c),v=u(h),d=i(p,v,!1),g=[],m=[];let y=0,k=0;d.forEach((e=>{switch(e){case"insert":m.push(["insert",[...v.values()][k++]]),g.push(["empty"]);break;case"delete":g.push(["delete",[...p.values()][y++]]),m.push(["empty"]);break;case"move":g.push(["move",[...p.values()][y++]]),m.push(["move",[...v.values()][k++]])}}));let w=0;const x=[];for(;w<Math.max(g.length,m.length);){const e=g[w]||["empty"],t=m[w]||["empty"];x.push({left:e,right:t}),++w}l.value=x},handleClear:function(){l.value=[]}}}});const p={ref:"leftFileRef",type:"file"},v={ref:"rightFileRef",type:"file"};h.render=function(e,n,a,o,u,i){const f=l("render-diff");return s(),r("div",null,[t("input",p,null,512),t("input",v,null,512),t("button",{onClick:n[1]||(n[1]=(...t)=>e.handleDiff&&e.handleDiff(...t))},"æ¯”å¯¹"),t("button",{onClick:n[2]||(n[2]=(...t)=>e.handleClear&&e.handleClear(...t))},"æ¸…é™¤ç»“æžœ"),t(f,{data:e.renderData},null,8,["data"])])};a(h).mount("#app");
